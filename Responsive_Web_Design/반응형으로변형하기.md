# 반응형으로 변형하기
이번 장에서는 기존 작업물을 반응형으로 바꾸는 방법을 살펴본다.

## 콘텍스트의 문제 
잘 설계된 반응형 디자인은 다른 콘텍스트에서도 방문자에게 훌륭한 연속성을 제공한다는 사실을 알 수 있다.  
그러나 일부 웹디자이너들은 기기마다 마크업을 각기 다르게 제공해야 한다고 반박한다.
그들의 주장엥서 생각해볼 점은 두 가지 정도이다.  
1. 기기가 콘텍스트를 의미하여 사용자가 이동중인지 머물러 있는 상태인지 알려준다.  
이러한 콘텍스트를 이용해 사용자를 분류하고 목표를 추론할 수 있다.
2. 사용자의 우선순위와 목표가 정말 콘텍스트마다 다르다면 모든 사용자에게 동일한 HTML 문서를 제공하는 것은  
적합하지 않다.

그러나 사용자의 콘텍스트를 추론하는 것이 단순히 기기를 분류하는 것으로 충분하지 않고, 많은 경우  
이렇게 __'콘텍스트를 고려해'__ 구현한 별도의 사이트는 다소 불완전하다.  
즉 '모바일'과 '데스크톱'과 같은 용어에 의존해 사용자에 대한 고민을 단순화할 수는 없다.  
중요한 점은 반응형 웹디자인이 모바일 웹사이트를 대신하기 위해 만들어진 것은 아니다.  
이는 프론트엔드 개발 전략의 일환이다. 채택 전에 여러분의 프로젝트의 요구 조건을 충족하는지 알아야 한다.  
결국 사이트에 반응형 웹디자인이 적합한지 판단할 수 있어야 한다.  

### 사용자의 목표 알기
저자는 가라오케 이벤트를 홍보하는 사이트를 제작한 경험을 이야기한다.  
주요 목적은 방문자에게 파티에 대한 정보와 스폰서, 파티 장소를 알려주는 것이었다.  
사이트에 모바일 친화적 요소도 필요하다고 판단한 저자는 청중들이 장소 정보에 대해 쉽고  
빠르게 접근할 수 있어야 한다고 생각했으며, 가장 좋아하는 참가자를 공연 중에 모바일 폰을 통해  
즉석에서 투표하게 만들기로 했다.  
데스크톱 사이트와 모바일 사이트의 목표가 완전히 다름을 알 수 있다.  
그렇다면 사이트의 페이지마다 두 콘텍스트의 마크업을 모두 담고, 미디어 쿼리와 __display: none__ 을 혼용해  
두 사이트 중 기기에 맞는 내용을 전달할 수 있을 것이다.  
그러나 이것은 올바른 접근 방식이 아니다.  
사용자가 보지도 않는 데다 별로 얻을 것도 없는 콘텐츠를 담은 불필요한 HTML을 사용자에게 전부 받도록  
하는 것은 무책임한 요구이다.

## 모바일 우선주의
2009년 말, 루크 로블로스키는 모바일 웹사이트 경험을 후순위로취금해서는 안된다고 주장했다.  
그는 최신 휴대폰이 지닌 기술적 성능과 더불어 모바일 웹 트래픽의 폭발적인 성장을 거론하며,  
웹 전문가들에게 모바일 우선의 디자인을 시작해야 한다고 제시했다.  
저자는 이 철학이 반응형 디자인 프로젝트에 절대적으로 유용하다는 사실을 발견했다.
모바일을 우선으로 디자인한다면 가장 중요한 것이 무엇인지 도출해야 한다.  
보통의 캔버스보다 80%나 작은 스크린으로 작업해야 한다면, 불필요한 콘텐츠와 쓸데없는 항목은  
제거하고 진정으로 사이트의 중요한 측면에 집중해야할 것이다.
모바일 우선주의 디자인은 최신 웹디자인에서 쉽게 간과해 왔던 '집중'이라는 측면을 추구함으로써  
사용자 모두의 경험을 풍요롭게 해줄 수 있다.

## 반응형 워크플로우
대부분의 사이트 제작 프로젝트는 _'선형적(waterfall)'_ 프로젝트 운영 작업흐름에 따라 작업한다.  
보통 기획, 디자인, 개발, 전달의 4가지 단계로 구분되며 각 단계에서 문서나 파일이 만들어진다.  
하지만 반응형 디자인은 이런 협업 방법으론 금방 작업하기 어려울 수 있다.  
저자는 _애자일(Agile)_ 접근 방식을 통해 '디자인' 및 '개발' 과정의 격차를 줄여 두 그룹이 좀더
밀접하게 협업하여 반응형 디자인을 완성할 수 있다고 말한다.

## 책임감 있는 반응형 디자인
책 전반에 걸쳐 가변 그리드, 가변 이미지, 미디어 쿼리가 함께 작용하면 사이트에 얼마나 더 나은  
반응형 접근 방식을 제공하는지 알아보았다.  
먼저 포토샵에서 작업한 고정적인 시안을 가지고 가변 그리드로 변환하며 작업을 시작했다.  
이후 본래의 콘텍스트를 벗어나면 크기가 조절되지 않는 문제점을 해결하기 위해 미디어 쿼리를  
사용하여 소형 스크린 레이아웃과 와이드 스크린 레이아웃을 만들었다. 마지막으로 미디어 쿼리를  
지원하지 않는 브라우저를 위해 respond.js 라이브러리를 적용해 레이아웃에 접근할 수 있음을 알았다.  
그러나 만약 @media를 인식하지 못하는 브라우저에서 자바스크립트를 사용하지 않는 경우는 어떨까?  
이 경우 기기의 적합성 여부와 관계 없이 무조건 데스크톱 사이트로 렌더링하게 되어 있다.  
즉 모바일 기기의 작은 공간에 큰 와이드 스크린 사이트가 구겨져 있는 것을 볼 수 있다. 
다른 문제도 있다.
```html
.blog{
    background: #F8F5F2 url("img/blog-bg.png") repeat-y;
}
@media screen and (max-width: 768px){
    .blog{
        background: #F8F5F2 url("img/noise.gif");
    }
}
```
위 CSS는 너비가 768px보다 작은 소형 디스플레이에서는 배경 이미지 대신 GIF 이미지가 깔리는 효과를 낸다.  
이 방법의 문제점은 최종적으로 페이지에 하나만 적용되더라도 일부 브라우저는 실제로 두 그래픽 모두  
다운로드한다는 것이다. 이는 소형 스크린 사용자에게 지나치게 무거운 이미지를 다운로드해야 하는  
불편을 주고 있다. 그렇다면 어떻게 해야 할까?  

### '모바일 우선주의' + 미디어 쿼리
반응형 디자인은 정리하자면, 기본 해상도를 시작으로 그 이후에 미디어 쿼리를 사용해 여러 콘텍스트에  
적절히 맞추는 방법이다. 반응형 디자인에서 더욱 책임감 있는 접근 방식은 데스크톱 레이아웃을 기본으로  
하는 것이 아니라 '모바일 우선주의'를 염두에 두고 스타일시트를 작성하는 방법이다.  
먼저 소형 스크린에 적합한 레이아웃을 정의한후 미디어 쿼리를 사용해 해상도 증가에 따라  
사이트를 점진적으로 향상시킬 수 있다.  
해상도 스펙트럼 전반에 걸쳐 사이트가 확대되도록 하기 위해서는 __min-width__ 미디어 쿼리를  
적용해야 한다. 스타일시트의 기본 구조는 다음과 비슷하다.  
```html
/* Default, linear layout */
.page {
    margin: 0 auto;
    max-width : 700px;
    background: #fff;
    position: relative;
}

@media screen and (min-width: 480px) {...}
@media screen and (min-width: 620px) {...}
@media screen and (min-width: 810px) {...}
@media screen and (min-width: 1400px) {...}
```
뷰표트가 설정한 브레이크포인트들을 넘어 확대되면 미디어 쿼리에 의해 적절한 레이아웃 규칙이 적용된다.  
이 방법의 이점은 무엇일까?  
만약 미디어 쿼리를 지원하지 않는 부라우저에 자바스크립트를 사용할 수 없는 경우라도     
기본 단일 열 레이아웃을 보여준다.

## 점진적 향상 적용하기
점진적 향상이란 먼저 최소 성능의 기기에 맞게 문서를 작성하고 점진적으로 꾸며 향상시키는 것을  
의미한다. 이러한 방식은 기준 기기에 과도한 짐을지우지 않으면서 최신 그래픽 브라우저 소프트웨어  
사용자에게 풍부한 경험을 제공한다.   
다시 말해 모든 기기에 기본 디자인을 제공하고 더 많은 기능을 갖춘 브라우저에 더 향상된 버전의 디자인을  
조건부로 제공한다. 결과적으로 HTML을 지원하는 모든 기기에서 페이지를 빠르게 불러오고, 향상된  
환경을 처리할 수 있는 브라우저에만 좀더 견고한 인터페이스로 업그레이드된 디자인을 제공한다.      
    
대부분의 웹사이트가 특정 모바일 환경을 염두에 두고 설계된 것이 아님에도 매일 셀 수 없는  
사용자들이 모바일 기기를 이용해 사이트에 접속한다는 점에서 점진적 향상의 필요성을 엿볼 수 있다.  
콘텐츠를 기기마다 다른 사이트에 단순히 저장하는 대신 점진적 향상 기법을 이용하면 성능 좋은    
기기에 향상된 경험을 제공하면서도 모든 기기에서 수준 높은 접근성을 확보할 수 있다.  

### 자바스크립트로 작업하기
#### 게으르게 하지만 지능적으로 로딩하는 콘텐츠
저자는 밑의 자바스크립트 코드와 html 파일을 약간 조작하여 자바스크립트를 이용해 구현된 Carousel이  
만약 자바스크립트를 사용할 수 없거나 jQuery가 파일을 불러오지 못할 경우 페이지 상단의 이미지 하나만  
나타나도록 하였다.    
(기본적인 Carousel의 경우 자바스크립트를 사용 못하는 환경이라면 슬라이드 전체가 겹친다.)
```html
(function( $ ) {
    $( function(){
        $.get("-/ajax/slides.html", function( data ){
            .append(data)
            .carousel();
        });
    });
}(jQuery));
```

#### 더 나은 향상  
간단한 Carousel 스크립트에 코드를 추가해 결과적으로 더욱 강려하고 접근성 노은 경험을 얻었다.  
페이지를 렌더링하는 브라우저나 기기의 성능에 어떠한 가정도 하지 않고, 자바 스크립트가  
사용 가능하다면 슬라이드가 나타나도록 했다.  
좀 더 발전시킬 수도 있다. 예를 들어 슬라이드 쇼를 특정 미디어 타입에서만 나타나도록 제한하고  
스크립트가 해상도에 따라 좌우되도록 만들 수 있다. 더 작은 화면에서 슬라이드를 로드할 수 없게  
하려면 다음과 같은 코드를 사용하면 된다.
```html
if (documemnt.documentElement.clientWidth >= 500) {   
    $(document).ready(function() {...});
}
```
위의 if 구문은 _min-width: 500 px_ 미디어 쿼리와 동등한 자바스크립트이다.  
스크린 너비가 500px보다 작으면 포함된 자바스크립트 코드는 동작하지 않는다.  
그리고 대역폭을 필요한만큼만 사용하는 방식으로 작업하면서 필라멘트 그룹이 제공하는 '반응형 이미지'  
라이브러리를 이용해 소형 스크린에 더 가볍고 ,더 친화적인 대역폭 이미지를 제공하고,  
와이드 스크린에 한해 전체 크기 이미지를 제공할 수 있다.  

이 접근 방식을 좀 더 다듬어 보자.  
이상적인 방법으로 Lab-JS나 yepnope 같은 가벼운 자바스크립트 로더를 사용해 사용자의 스크린이 특정  
해상도 범위 이상인 경우에 한해 jQuery, carousel 플러그인, custom.js를 동적으로 불러오도록 한다.  
이렇게 하면 저 사양 기기의 사용자가 자바스크립트 전체를 다운로드할 때 부하가 걸리는 것을  
막을 수 있다. 특히 carousel 플러그인이 제대로 작동하지 않을 경우 더 유용하다.

## 전진하며 반응형 유지하기
반응형 웹디자인은 웹의 내재된 가변성에 맞추어 더욱 완벽한 사이트를 제작하는 해법이다.  
우리가 사용자의 요구를 면밀히 조사하고, 구체적인 속성을 신중히 적용한다면 반응형 웹디자인은  
실로 강력한 접근 방법이 될 것이다.